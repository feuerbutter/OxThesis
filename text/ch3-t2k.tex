\begin{savequote}[8cm]
\textlatin{Neque porro quisquam est qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit...}

There is no one who loves pain itself, who seeks after it and wants to have it, simply because it is pain...
  \qauthor{--- Cicero's \textit{de Finibus Bonorum et Malorum}}
\end{savequote}

\chapter{\label{ch:t2k}The T2K Experiment} 

\minitoc
The T2K experiment is a long-baseline neutrino experiment, aiming to measure CP violation in the lepton sector through neutrino oscillation measurement.
This chapter will first describe the experimental setup and provide a brief overview of the software, which forms the ground for understanding and discussion of the subsequent analyses.


\section{Hardware}
  As a long-baseline experiment, T2K is comprised of a near detector, ND280, and a far detector, Super-Kamiokande (Super-K).
  To measure neutrino oscillation, both detectors need to be able to distinguish between $\numu$ and $\nue$.  
  Of course, no detectors can detect neutrinos directly.
  In practice, both detectors should possess the capability to distinguish well the different products from neutrino interaction with the active material of the detectors.
  The most common products of neutrino-nucleus interactions are the corresponding leptons, i.e. electron and muon, and several hadrons, including protons, nucleons and light mesons like pions.

  The far detector, SK, is a huge water Cherenkov detector.
  It detects the presence of particles by capturing the Cherenkov light emitted due to their superluminal motion in water.
  Hadrons produced in neutrino interactions are not energetic enough to emit Cherenkov radiation, while the leptons typically are able to travel faster than light.
  Thus, SK mainly measure electrons and muons.
  The Cherenkov radiation from these leptons typically forms a ring-like pattern perpendicular to the particle motion.
  Due to the lighter mass of the electron, its propagation direction is more likely to change due to scattering along its motion than muon.
  Hence, the Cherenkov ring from an electron is more diffuse than that from a muon, as shown in Fig.~\ref{fig:sk-e-mu}.
  \begin{figure}
        \centering
        \begin{subfigure}[b]{\dbfigwid\textwidth}
             \centering
             \includegraphics[width=\textwidth]{figures/t2k/sk-nue.eps}
             \caption{nue}
             \label{subfig:sk-nue}
        \end{subfigure}
        \begin{subfigure}[b]{\dbfigwid\textwidth}
             \centering
             \includegraphics[width=\textwidth]{figures/t2k/sk-numu.eps}
             \caption{numu}
             \label{subfig:sk-numu}
        \end{subfigure}
        \caption{SK event displays.}
        \label{fig:sk-e-mu}
  \end{figure}

  In contrast, the near detector, ND280, consists of multiple advanced sub-detectors and is capable of detecting hadrons.
  The classic ND280 is shown in Fig.~\ref{subfig:nd280-classic}.
  The main detector complex contains a $\piz$-detector (P0D), three vertical Time Projection Chambers (TPC) and two Fine Grained Detectors (FGD) sandwiched between the vertical TPCs.
  These detectors are surrounded by several energy calorimeters (ECAL), namely the P0D ECAL, the Barrel ECAL, the Upstream ECAL and the Downstream ECAL, which are further enclosed by the UA1 magnet, which is made up of the solenoid coil and the yoke. 
  \begin{figure}
        \centering
        \begin{subfigure}[b]{\dbfigwid\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/t2k/ND280-classic.eps}
            \caption{classic}
            \label{subfig:nd280-classic}
        \end{subfigure}
        \begin{subfigure}[b]{\dbfigwid\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/t2k/ND280-up.png}
            \caption{upgrade}
            \label{subfig:nd280-up}
        \end{subfigure}
        \caption{ND280 detector diagram.}
        \label{fig:nd280-diagram}
  \end{figure}
  The neutrino travels through P0D, TPCs and FGDs. 
  The FGDs are made up of scintillation bars each with a cross section of $1.0~\cm$ by $1.0~\cm$. 
  Each layer of scintillation bars is arranged orthogonal to the previous.
  As the particle passes through the layers scintillation bars, it will excite photons, which will be collected by the wave-length shifting optical fibre in the middle of the bar and collected by the electronics at the end of the bar.
  Hence, the track position information transverse to the neutrino direction is provided by checking which scintillation bar has been excited, while the longitudinal information is given by the number of layer the excitation takes place.
  Before the upgrade, FGDs are the active target where neutrino interaction happens.
  One shortfall of the bar geometry of the scintillator is the low acceptance rate for particles travelling at large angle to the beam direction, i.e. close to the long axis of a single bar, as these particles would only pass through a limited number of bars before existing the detector and hence are difficult to reconstruct.
  This leads to a mis-match of the phase spcae between the near and far detector as particle acceptance at SK is isotropic, leading to additional systematics in oscillation analysis.
  Besides, reconstruction resolution also suffers from the small number of signals along the particle track.
  These are the two of the major motivations for upgrading ND280.

  As the shortcomings are largely due to the bar shape of the scintillators, the ND280 upgrade has aptly used cubic scintillators for the new active target, the Super Fine Grained Detector (SFGD).
  In the upgrade, the $\piz$ detector is replaced by a suite of sophisticated new sub-detectors, as shown in Fig.~\ref{subfig:nd280-up}, namely the Time-of-flight detector (TOF), two high angle TPCs (HATs) and the Super Fine Grained Detector (SFGD). 
  The TOF consists of 6 planes of scintillation bars, providing excellent sub-nano second timing resolution. 
  It can effectively veto trespassing particles, thus improving the sample purity.
  HATs have a new field cage design and new Micromegas, leading to a larger tracking volume and better resolution than the existing vertical TPCs in ND280. 
  The SFGD is the new active target, consisting of about 2 million scintillation cubes, each with a size of $1~\cm^3$. 
  The granularity of SFGD improves the high-angle acceptance significantly and thus leads to better phase space matching between the ND and the FD. 
  Moreover, the tracking capabilities are also enhanced by the more precise measurement of energy deposited along the particle track. 
  Hence, detection thresholds are lowered and resolution improved, opening up avenues for novel reconstruction techniques, such as trackless pion reconstruction, and creative construction of variables, like COM variables, both of which will be illustrated in the next chapter. 
  The upgrade has finished in April 2024 and the upgraded ND280 has started taking data in June 2024. 
  
  % An example event display is shown in Fig.~\ref{fig:ndup-evedis}. 
    % \begin{figure}[!htb]
    %     \centering
    %     \includegraphics[width=0.5\linewidth]{fig/upgradeEvtDis.png}
    %     \caption{Event display of a possible $\pi^+$ event.}
    %     \label{fig:ndup-evedis}
    % \end{figure}

\section{Software}
  \label{sec:t2k-sw}
  As a considerable portion of this thesis consists of improvement made on reconstruction performance, it is also apt to provide an overarching introduction to the reconstruction framework implemented for the T2K ND upgrade to aid understanding of the content follows.

  Each scintillation fibre in the SFGD constitutes a electronic signal channel.
  Hence, scintillation photons produced as a particle travels through the cubes are collected by the three planes of electronic boards on the three sides of SFGD.
  These electronic signal will be converted to digital singals after calibration.
  The three 2-dimensional planes of signals are then combined into one collectiion of 3-dimensional "Hits", each of which corresponds to a cube, with a 3-dimensional coordinate and a number of charges deposited. 
  These "Hits" are then passed through a combination of grouping and track-fitting algorithms, which collects the Hits into physically identifiable objects, namely clusters and tracks. 
  Clusters are isolated objects, which are not long enough to form a track, usually with less than 3 Hits.
  Tracks, on the other hand, contain many more Hits. 
  However, as the optical insulation coating on the cube is not perfect, there bounds to be leakage of photons to the neighbouring cubes that the particle has not actually passed by.
  Hence, the reconstruction algorithm also combines neighbouring Hits into Nodes, which reflect the particle trajectory more closely.
  Besides, the energy deposited at each Node is also estimated from the charges deposited at the constituent Hits and is further smoothed due to physical considerations that the energy deposited along a particle trajectgory is expected to be continuous.
  The smoothed energy along with other accessible information is passed through a Boosted Decision Tree (BDT) algorithm, trained on Particle Gun (PGUN) simulations, for particle identification and momentum reconstruction.
