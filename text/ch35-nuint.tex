\begin{savequote}[8cm]
\textlatin{Neque porro quisquam est qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit...}

There is no one who loves pain itself, who seeks after it and wants to have it, simply because it is pain...
  \qauthor{--- Cicero's \textit{de Finibus Bonorum et Malorum}}
\end{savequote}

\chapter{\label{ch:35-nuint}Neutrino interactions} 
\minitoc
The underlying theory for neutrino oscillation is straightforward, and the parameters to be measured are clear, but the experimental determination of these parameters is challenging.
Due to the weak interaction of neutrinos, they cannot be detected directly.A
All neutrino measurements are based on the detection of the particles produced in the neutrino interaction.
Therefore, to extract the desired neutrino oscillation parameters with a high precision, a good understanding of neutrino interactions is crucial.
This chapter provides the basic understanding of neutrino interactions necessary for the interpretation of the analyses presented in the subsequent chapters.

\section{nu-quark}
The most fundamental interaction between a neutrino and matter is the weak interactions between the neutrino and a quark, the Feynman diagrams for which are shown in Fig.~\ref{fig:nu-q-feyn}.

\begin{figure}[h]
  \centering
  \begin{subfigure}[b]{0.45\textwidth}
    \centering
    \begin{tikzpicture}
      \begin{feynman}
        \vertex (a) {\(\nu_\ell\)};
        \vertex [right=of a] (b);
        \vertex [right=of b] (c) {\(\ell\)};
        \vertex [below=of b] (d);
        \vertex [left=of d] (e) {\(q\)};
        \vertex [right=of d] (f) {\(q'\)};
        
        \diagram* {
          (a) -- [fermion] (b) -- [fermion] (c),
          (b) -- [boson, edge label=\(W\)] (d),
          (e) -- [fermion] (d) -- [fermion] (f),
        };
      \end{feynman}
    \end{tikzpicture}
    \caption{Charge current interaction.}
    \label{fig:cc-interaction}
  \end{subfigure}
  \hfill
  \begin{subfigure}[b]{0.45\textwidth}
    \centering
    \begin{tikzpicture}
      \begin{feynman}
        \vertex (a) {\(\nu_\ell\)};
        \vertex [right=of a] (b);
        \vertex [right=of b] (c) {\(\nu_\ell\)};
        \vertex [below=of b] (d);
        \vertex [left=of d] (e) {\(q\)};
        \vertex [right=of d] (f) {\(q\)};
        
        \diagram* {
          (a) -- [fermion] (b) -- [fermion] (c),
          (b) -- [boson, edge label=\(Z\)] (d),
          (e) -- [fermion] (d) -- [fermion] (f),
        };
      \end{feynman}
    \end{tikzpicture}
    \caption{Neutral current interaction.}
    \label{fig:nc-interaction}
  \end{subfigure}
  \caption{Feynman diagrams for neutrino interactions with a quark.}
  \label{fig:nu-q-feyn}
\end{figure}
More specifically, Fig.~\ref{fig:cc-interaction} is mediated by the $W$ boson and the neutrino is converted to a charged lepton, while Fig.~\ref{fig:nc-interaction} is mediated by the $Z$ boson and the neutrino remains a neutrino.
The former is the charged current (CC) interaction, while the latter is the neutral current (NC) interaction.
Following the Feynman diagram, it is straightforward to write down the amplitude for the interaction.
The amplitude for the CC interaction is given by:
\begin{equation}
  \mathcal{M}_{\text{CC}} = \frac{g^2}{2} \bar{u}_\ell(p') \gamma^\mu (1 - \gamma^5) u_\nu(p) \frac{-i g_{\mu\nu}}{q^2 - M_W^2} \bar{u}_q(k') \gamma^\nu (1 - \gamma^5) u_q(k),
\end{equation}
where $g$ is the weak coupling constant, $u_\ell$ and $u_\nu$ are the spinors for the outgoing lepton and incoming neutrino, respectively, $u_q$ are the spinors for the quarks, $q$ is the momentum transfer, and $M_W$ is the mass of the $W$ boson.
This interaction takes place only when the neutrino possesses high enough energy <how high?> to probe inside the nucleon and interact with the quarks.
The product quark will hadronize and produce a jet of particles.
This type of interaction is refered to as deep inelastic scattering (DIS).
DIS is highly complicated, but no so relevant for this thesis, so will not be discussed further.
More details can be found in reviews, such as Ref.~\cite{}. <DIS review>

\section{nu-nucleon}
At the T2K beam energy, the predominant fraction of the neutrinos do not possess the energy to probe inside the nucleon, but rather interact with the nucleon as a whole.
Depending on the specific neutrino energy, the interaction can be classified as quasi-elastic (QE), resonance, or deep inelastic scattering (DIS).

  \subsection{QE}
  Although at the quark level, the interaction appears to the same as the $\nu$-quark interaction shown in Fig.~\ref{fig:nu-q-feyn}, the interacted quark cannot be treated as independent, but rather as part of a nucleon.
  Hence, the effective $\nu$-nucleon interaction feynman diagram is shown in Fig.~\ref{fig:nu-n-feyn}.
  \begin{figure}[h]
    \centering
    \begin{subfigure}[b]{0.45\textwidth}
      \centering
      \begin{tikzpicture}
        \begin{feynman}
          \vertex (a) {\(\nu_\ell\)};
          \vertex [right=of a] (b);
          \vertex [right=of b] (c) {\(\ell\)};
          \vertex [below=of b] (d);
          \vertex [left=of d] (e) {\(N\)};
          \vertex [right=of d] (f) {\(N'\)};
          
          \diagram* {
            (a) -- [fermion] (b) -- [fermion] (c),
            (b) -- [boson, edge label=\(W\)] (d),
            (e) -- [fermion] (d) -- [fermion] (f),
          };
        \end{feynman}
      \end{tikzpicture}
      \caption{Charge current interaction.}
      \label{fig:cc-interaction-n}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.45\textwidth}
      \centering
      \begin{tikzpicture}
        \begin{feynman}
          \vertex (a) {\(\nu_\ell\)};
          \vertex [right=of a] (b);
          \vertex [right=of b] (c) {\(\nu_\ell\)};
          \vertex [below=of b] (d);
          \vertex [left=of d] (e) {\(N\)};
          \vertex [right=of d] (f) {\(N\)};
          
          \diagram* {
            (a) -- [fermion] (b) -- [fermion] (c),
            (b) -- [boson, edge label=\(Z\)] (d),
            (e) -- [fermion] (d) -- [fermion] (f),
          };
        \end{feynman}
      \end{tikzpicture}
      \caption{Neutral current interaction.}
      \label{fig:nc-interaction-n}
    \end{subfigure}
    \caption{Feynman diagrams for neutrino interactions with a nucleon.}
    \label{fig:nu-n-feyn}
  \end{figure}
  The leptonic current remains the same, but the hadronic current is now a nucleon current instead of a quark current.
  Hence, the hadronic current is much more complicated and and comprises of several form factors, which paramterize our understanding of the nucleon structure.
  For instance, the hadronic current for the CC interaction is given by:
  \begin{equation}
    \mathcal{M}_{\text{CC}} = \frac{G_F}{\sqrt{2}} \bar{u}_\ell(p') \gamma^\mu (1 - \gamma^5) u_\nu(p) \bar{u}_N(k') \left[ F_1(q^2) \gamma_\mu + F_2(q^2) \frac{i \sigma_{\mu\nu} q^\nu}{2M} + F_A(q^2) \gamma_\mu \gamma^5 + F_P(q^2) \frac{q_\mu \gamma^5}{m_\pi} \right] u_N(k),
  \end{equation}
  where $G_F$ is the Fermi constant, $F_1$, $F_2$, $F_A$, and $F_P$ are the form factors, $M$ is the nucleon mass, and $m_\pi$ is the pion mass.
  The derivation is complicated and beyond the scope of this thesis. 
  More details can be found in Ref.~\cite{LlewellynSmith:1978te}.
  It is however important to note that $F_1$ and $F_2$ are the vector form factors, which can be extracted from the electron scattering measurements, and $F_P$ is the pseudoscalar form factor, which can be related to $F_A$, the axial form factor, through the Partially Conserved Axial Current Hypothesis (PCAC) .
  Hence, the axial form factor is unique to neutrion experiments and can only be extracted from past measurements.

  \subsection{Resonance}
  When the neutrino energy is high enough to excite the nucleon to a higher energy state, e.g. $\Delta(1232)$ the interaction is classified as a resonance interaction.
  The excited nucleon then decays to produce a pion. 
  Hence, the resonance modelling is sometimes used interchangeably with the single pion production modelling.
  One of the most common moodel used today is the Berger-Sehgal model, which improves from the earlier Rein-Sehgal model by taking into account the effect of the lepton mass. (CHECK)
  The Rein-Sehgal model is based on the approximate relativistic quark model in Ref.~\cite{Feynman:1971wr}.
  Subsequent developments such as the MK model~\cite{Kabirnezhad:2017jmf,Kabirnezhad:2020wtp,Kabirnezhad:2022znc}, provides more sophisticated calculations.


\section{nu-nucleus}
Modern day neutrino experiments employ heavier elements, such as hydrocarbon and argon, to increase event rates.
This further complicates the neutrino interaction.
The simplest case is for the relatively high energy neutrino, for which the Impulse Approximation (IA) can be used.
The neutrino sees the nucleon as independent from other nucleons, so the interaction approaches the $\nu$-N interaction.
Even in this simplest case, the presence of the nuclear medium still affects the interaction in two ways, namely the intial state (IS) effect and the final state interaction (FSI).

When the neutrino energy drops, IA is no longer valid and can only resolve the nucleus as a whole.
In this case, Random Phase Approximation (RPA) correction is needed, which is beyond the scope of this thesis and will not be ellaborated further. 
Interest readers can refer to REFXXX for more details.
Instead, the two nuclear effects will be elaborated further below.

  \subsection{Initial state}
  The nuclear effects manifest in two ways.
  Firstly, the nucleon in the interaction is in a bound state, i.e. it cannot have arbitrary energy and momentum like a free nucleon.
  Instead, the energy distribution of the nucleon is parameterised by the so-called Spectral Function (SF).
  The simplest form of SF is the Fermi Gas model, which treats the nucleons as freely moving Fermi gas.
  Hence, the nucleon momentum is filled up to the Fermi momentum, which is given as:
  <CHECK>
  \begin{equation}
      k_F = (3\pi^2 \rho/2)^{1/3},
  \end{equation}
  where $\rho$ is the nuclear density.
  <How is the fermi momentum determined?>
  This model oversimplifies the nuclear structure.
  A more realistic model is the local Fermi gas (LFG) model, which accounts for the varying nuclear density, leading to an SF of the form:
  (CHECK)
  \begin{equation}
      S(k, E) = \int \rho(\vec{r}) \delta(E - \sqrt{k^2 + m^2}) d^3r,
  \end{equation}
  where $m$ is the nucleon mass.

  Further improvement, such as the short-range correlation between nucleons that increases the high momentum fraction.
  There are also effective SFs. Fit to data?

  \subsection{FSI}
  \label{sec:nuint-fsi}
  The second nuclear effect is the Final State Interaction (FSI).
  Regardless of how the neutrino interacts with the nucleon, the interaction products are still inside the nucleus.
  They have to propagate through the nuclear medium to be detectable.
  The interactions with the nuclear medium are classified as FSI.
  They are more pronounced for hadrons than leptons, as the former are more likely to interact with the nuclear medium.
  There are several types of FSI, such as the elastic scattering, charge exchange, and absorption.
  \begin{enumerate}
      \item 
  CEX involves changing the charge of the participating particles; for example,
  \begin{equation}
      \pip + \n \rightarrow \piz + \p,
  \end{equation}
  or vice versa. This rescattering type is crucial for event topologies requiring the presence of a pion;  depending on the signal pion charge, CEX could migrate events between signal and background. 

  \item 
  INEL is the case where the nucleus is left in an excited state after the rescattering. This category only contains the situation where a single additional nucleon is emitted/knocked-out after rescattering. Since it does not affect the number of pions produced, it will not convert an event from a pionless topology to a pion-production topology. The effects on nucleons are two-fold. Firstly, it can alter the number of signal events within each event topology. If the inelastic rescattering leads to two low-momentum protons below the detection threshold as opposed to a high-momentum proton, this signal event will be discarded as no protons are observed. Secondly, INEL invariably changes the kinematics of the rescattering particle. Be it the leading proton or the leading pion, based on which the TKI observables are calculated, the TKI distribution shape will be affected. Hence, while $\ninel$ would affect all four data sets, $\piinel$ would only affect \ttkpip and \minpiz. 

  \item 
  ABS refers to the case where the particle undergoes an interaction so that it does not emerge as a final particle. For example, $\pi^+$ can interact with two or more nucleons, initially forming a baryon resonance that subsequently interacts with other nucleons, emitting multiple nucleons rather than pions. Hence, the $\pi^+$ would not emerge from the nucleus anymore.

  \item 
  PIPD happens for energetic particles where an extra pion emerges as a result of the rescattering, such as
  \begin{equation}
      \p + \p \rightarrow \p + \n + \pip.
  \end{equation}
  Such an interaction significantly alters the event topology. 

  \end{enumerate}


\section{\label{sec:1-intro}Introduction}

Neutrinos play a central role in advancing our understanding of physics and addressing fundamental inquiries in contemporary science. The Hyper-Kamiokande experiment~\cite{Hyper-Kamiokande:2018ofw} aims to conduct precise measurements of charge parity violation within the neutrino sector, a phenomenon believed to be closely linked to the observed matter-antimatter asymmetry in the universe. Similarly, the Deep Underground Neutrino Experiment (DUNE)~\cite{DUNE:2016hlj,DUNE:2015lol,DUNE:2016evb,DUNE:2016rla,DUNE:2021tad}  promises the same, in addition to elucidating the neutrino mass ordering. Whether seeking to ascertain Standard Model parameters or probing for exotic phenomena, significant enhancements in both theoretical frameworks and computational simulations of neutrino-nucleus interactions are imperative. As neutrinos interact mainly with nucleons inside the nucleus, the interaction is subject to nuclear effects, namely the nucleon initial state and final-state interactions (FSIs). These effects are difficult to calculate and can alter the final event topology by changing the number of final state pions with respect to the interactions on free nucleons. Notably, the neutrino flux at DUNE yields a comparable proportion of events with and without pions in the final state, highlighting the pressing need for a generator capable of accurately describing both event topologies.


\section{TKI}
\label{sec:nuint-tki}

\begin{figure}[!htb] 	
    \centering 		
    \includegraphics[width=0.35\textwidth]{figures/stki.eps}
    \caption{\label{fig:stki} Schematic illustration of the TKI variables. Diagram taken from Ref.~\cite{Lu:2015tcr}.} 
\end{figure}

The TKI variables are shown in Fig.~\ref{fig:stki}. They are cleverly constructed such that they are most sensitive to IS and FSI. 
In the simplest case, there are only two final particles after the neutrino-nucleon interaction, a muon and a proton. 
If the initial momentum of the struck nucleon has no component transverse to the neutrino's incoming direction, the products, i.e. the muon and the proton, should not have a net transverse component either, unless the struck nucleon has a non-zero initial transverse component or the final particles have undergone FSI.
Suppose there is no FSI, the net transverse component, $\dpt$, corresponds exactly to the magnitude of the transverse component of the struck nucleon, and the angle, $\dat$, represents the direction of the initial nucleon motion projected on the transverse plane. 
Assuming the nucleons are moving isotropically, the $\dat$ distribution should be flat. 
All current nuclear models do not have a preferential direction for initial nuclear motion, so it is only natural to assume the nucleons move in random directions. 
Thus, the deviation from flatness for $\dat$ can only be due to FSI, thereby making it an excellent probe for FSI. 
As for $\dpt$, it reflects the magnitude of the initial nucleon momentum transverse to the neutrino direction compounded by FSI. 
Furthermore, if the nucleus is assumed to be at rest and no other particles are knocked out other than the muon and the proton, the initial nucleon momentum, $\pn$, can also be derived following the steps outlined in \cite{pnpaper}. 
 

\section{TKI measurements}\label{sec:tki}

TKI is a methodology based on the conservation of momentum in neutrino interactions. In essence, it involves quantifying the imbalance between the observed transverse momentum of the final-state particles and the expected transverse momentum from neutrino interactions with free nucleons~\cite{Lu:2015hea, Lu:2015tcr}. This ``kinematic mismatch'' together with its longitudinal and three-dimensional variations~\cite{Furmanski:2016wqo, Lu:2019nmf}, and the derived asymmetry~\cite{Cai:2019jzk}, has been a crucial set of observables, establishing a pathway to extract valuable information about the participating particles and the underlying nuclear processes. Recent experimental results from neutrino experiments such as  T2K~\cite{T2K:2018rnz, T2K:2021naz}, MINERvA~\cite{MINERvA:2018hba, MINERvA:2019ope, MINERvA:2020anu, MINERvA:2021csy}, and MicroBooNE~\cite{MicroBooNE:2022emb, MicroBooNE:2023cmw, MicroBooNE:2023tzj, MicroBooNE:2023wzy, MicroBooNE:2024tmp}, as well as electron scattering experiments such as  CLAS~\cite{CLAS:2021neh}, highlight the efficacy of TKI. 

\begin{figure}[!htb] 	
    \centering 		
    \includegraphics[width=0.35\textwidth]{figures/stki.eps}
    \caption{\label{fig:stki} Schematic illustration of the TKI variables. Diagram taken from Ref.~\cite{Lu:2015tcr}.} 
\end{figure}

In neutrino scattering off a free nucleon, the sum of the transverse components of the final products is expected to be zero, visualized through a back-to-back configuration between the final-state lepton and hadronic system in the  plane transverse to the neutrino direction. Hence, in a neutrino interaction with a nucleus, the transverse momentum imbalance, $\dpt$~\cite{Lu:2015tcr}, results from intranuclear dynamics, including Fermi motion and FSIs  as shown in Fig.~\ref{fig:stki}. The deviation from being back-to-back is quantified by the  coplanarity angle $\dphit$~\cite{Lu:2015tcr}, while the transverse boosting angle, $\dat$~\cite{Lu:2015tcr}, represents the direction of $\dpt$ within the transverse plane. Furthermore, analyzing the energy and longitudinal momentum budget~\cite{Furmanski:2016wqo, Lu:2019nmf} enables the conversion of $\dpt$ to the emulated (initial) nucleon momentum, $\pn$,  providing further insight into the Fermi motion; this conversion amounts to a correction on the order of $\mathcal{O}(20\%)$~\cite{Yang:2023dxk}. 
With one-body currents in the absence of FSIs, $\dat$ remains uniform (except for second-order effects, such as variations in the center-of-mass energy), given the isotropic nature of the initial nucleon motion. However, as the final products propagate through the nuclear medium, they experience FSIs, thereby disturbing the isotropy and the Fermi motion peak of the $\dat$ and $\pn$ ($\dpt$) distributions, respectively. Hence, $\dpt$ and $\pn$ elucidate the Fermi motion details, while $\dat$  characterizes the FSI strength---crucial for understanding medium effects in neutrino interactions. A notable advantage of these observables is their minimal dependence on neutrino energy~\cite{Lu:2015tcr}. Moreover, the double TKI variable, $\dptt$~\cite{Lu:2015hea}, is the projection of $\vecdpt$ along the axis perpendicular to the lepton scattering plane (hence ``double''). In addition to its use for extracting neutrino-hydrogen interactions~\cite{Lu:2015hea, Hamacher-Baumann:2020ogq}, it has also been applied to study nuclear effects in neutrino pion productions~\cite{MINERvA:2020anu, T2K:2021naz}. Its equivalent in pionless production, $\dptx$, has been proposed and studied together with its orthogonal companion, $\dpty$, in MINERvA~\cite{MINERvA:2019ope}.