\begin{savequote}[8cm]
\begin{CJK*}{UTF8}{gbsn}
  银鞍照白马，飒沓如流星。
\end{CJK*}

With great techniques come great measurements.
  \qauthor{--- Bai Li \textit{Xia Ke Xing}}

\end{savequote}

\chapter{\label{ch:techniques}New Techniques in Selection Development} 
\minitoc

The upgraded detector has enhanced measuring capabilities, which is especially important for hadrons,
As hadrons tend to have much shorter tracks and are conventionally harder to reconstruct in scintillator detectors compared to muons, the previously explored hadronic kinematic phase space has been relatively restricted, and the reconstructed hadronic variables have relatively large uncertainties.
Since more exclusive event topologies, such as $\numuccopiop$, allow the measurement of high-level variables like the Transverse Kinematic Imbalance (TKI) variables, which provide invaluable insights on neutrino-nucleus interactions, it is highly desirable to reconstruct hadrons, measure their kinematic properties as precisely as possible, and explore their phase space as extensively as possible.

Two of the most common product hadrons from neutrino-nucleus interactions are protons and pions. 
The default particle identification and momentum reconstruction have been developed by colleagues at T2K using the Boosted Decision Tree (BDT) algorithm, which is a machine learning algorithm that takes the energy deposit as the input and outputs the particle identity and momentum. 
The BDT algorithm has good performance, but it is still lacking in some aspects.
For instance, as it uses only single-track information, it cannot effectively distinguish between pions and muons. 
It can reconstruct proton momentum with an excellent resolution of about $3.5\%$, but it is insufficient for TKI analysis, which is highly sensitive to hadron kinematics. 

To address these gaps, I have developed and implemented new techniques for both hadrons, exploiting the precise position and $\dedx$ measurements and timing resolution.
For pions, I have invented the pion trackless reconstruction, a novel technique to reconstruct pions without requiring the presence of a reconstructed track, thereby lowering the detection threshold and significantly increasing reconstruction efficiency for low-momentum pions. 
As for protons, I have adapted the Elastically Scattered and Contained (ESC) protons technique~\cite{Lu:2016mjf} to SFGD, showing significant improvement in proton momentum reconstruction resolution,  
These new techniques are applied in the development of two signal sample selections, namely the $\numucczpiop$-ESC selection and the $\numuccopi$-TL selection, where the ``TL'' refers to the use of the trackless reconstruction technique.
Additionally, to prepare for the data-MC comparisons and future cross-section analysis, I have also developed a stopping pion control sample selection.

\section{$\numucczpiop$-ESC}
\label{sec:sel-esc}
     % The $\numucczpiop$-ESC adds an additional ESC selection step to the $\numucczpiop$ selection developed by a T2K colleague.
     % The details of the ESC step are elaborated below.
   %------------------- ESC ----------------%
    \subsection{Working Principles of the ESC technique}
    \label{sec:sel-esc-wp}
     The subsection elaborates on the underlying principles of the ESC selection technique.
     Protons coming to rest deposit a large amount of energy within a short distance just before stopping.
     Hence, for these protons, if the energy deposited per distance, $\dedx$, is plotted along the particle trajectory, a peak, the so-called Bragg Peak, appears near the track end.
     This feature can be exploited to select protons that come to rest without undergoing secondary interactions, which are thus called "elastically scattered" protons by the original developer of the technique~\cite{Lu:2016mjf}.
     To identify the Bragg peak, the entire proton track must be contained within the scintillation detector such that the $\dedx$ can be measured at the end of the track.
     Thus, this technique is called the elastically scattered and contained technique.
     These ESC protons are of particular interest because their range is strongly correlated with their momentum, which could be exploited by the machine learning algorithm.
     Hence, even though all proton momenta are reconstructed by the BDT algorithm, the ESC protons tend to better momentum reconstruction resolution.

     In the SFGD, having the Bragg peak implies large $\dedx$ for the last few nodes of the proton track.
     For illustration, the fractional difference between the reconstructed and true proton momentum is plotted against the energy deposited at the third last node of the proton track in Fig.~\ref{fig:dedx-pprres-eg} with column normalization.
     More specifically, all bins with the same $x$ value are considered to be in the same column, and the bin height is normalized by the largest bin height in the column.
     Thus, the maximum value in each column is $1$, thereby visualising the comparison between columns.
     For instance, in Fig.~\ref{fig:dedx-pprres-eg}, the red bins (the bin with the largest value) concentrate around $y=0$, i.e. small differences between reconstructed and true proton momentum, for columns having $\dedx$ above $1000$ arbitrary units\footnote{ 
     The energy deposit output from the SFGD reconstruction does not have a physical unit, but its magnitude is an algorithmic estimate of the energy deposited by the particle at each node.}, while for columns with $\dedx$ below $1000$, the red bins deviate from $y=0$ with larger fluctuations.
     Thus, selecting protons with large $\dedx$ for the last few nodes of the proton track can produce a sample with good proton momentum reconstruction resolution.
     This is the underlying principle of the ESC technique.
    \begin{figure}[h]
        \centering
     %    \includegraphics[width=\sgfidwid\linewidth]{figures/sel/an_dedx2_colnor_vs_p_pr_res_hist2d_al12_zoom.png}
        \includegraphics[width=\sgfidwid\linewidth]{figures/sel/fig51.eps}
        \caption{Proton momentum fractional difference against energy deposited at the third last node.}
        \label{fig:dedx-pprres-eg}
    \end{figure}
    
   \subsection{Implementation}
   \label{sec:sel-esc-imp}
	As the ESC selection is based on $\dedx$ at the end of the proton track, accurate reconstruction of $\dedx$ must first be obtained.
     The ND280 reconstruction software provides a smoothed energy deposit at each node as an estimate of $\dedx$.
	To investigate the quality of this estimate of $\dedx$, I have simulated multiple particle gun (PGUN) samples with protons travelling in different directions in the SFGD.
	More specifically, three samples travel along the $x$-, $y$-, and $z$-axes, and five other samples travel at $15^\circ$, $30^\circ$, $45^\circ$, $60^\circ$, and $75^\circ$ to the $x$-axis in the $x$-$z$ plane.
	As the proton direction should not affect its energy deposition, distinct characteristics of $\dedx$ along the proton trajectory should be consistent for the different proton samples.
     This consistency can be an indicator of the quality of the reconstructed $\dedx$.

     The first feature is the Bragg peak due to the ESC protons as elaborated in Sec.~\ref{sec:sel-esc-wp}.
	Another distinct feature of $\dedx$ is the minimal ionizing particle (MIP) region, where particles at high momentum traverse the scintillator depositing a minimal amount of energy, $E_{\textrm{MIP}}$, per unit distance.
     This is due to the fact that the energy loss of a particle travelling through matter is proportional to the square of its charge and inversely proportional to its velocity, as described by the Bethe-Bloch formula~\cite{Bethe:1930zza}.
     For protons, which are charged particles, the $\dedx$ is relatively constant at high momentum, as they are fast enough that their energy loss per unit distance is dominated by ionization losses rather than other processes like nuclear interactions or radiation losses.
     Hence, for protons travelling at high momentum, the $\dedx$ remains at a relatively constant and small value for all such particles.
	Hence, the $\dedx$ remains at a relatively constant and small value for all such particles.
     When a proton undergoes a secondary interaction while still possessing high momentum, its track ends prematurely, and the $\dedx$ values near the end of this track would be close to $E_{\textrm{MIP}}$ per distance.
	Thus, when the $\dedx$ values for each node near the end of the proton tracks are plotted, besides the Bragg peak at large $\dedx$ corresponding to ESC protons, there should be another peak at smaller $\dedx$ corresponding to protons that undergo secondary interactions, which will be referred to as the MIP peak for subsequent discussion.

	Fig.~\ref{subfig:esc-smooth-e} plots the smoothed energy deposits for the third to sixth nodes from the end for all PGUN samples travelling at non-orthogonal angles.
	It is reassuring to indeed observe the two peaks, the MIP peak and the Bragg peak, as hypothesized. 
     \begin{figure}
        \centering
        \begin{subfigure}[b]{\dbfigwid\textwidth}
             \centering
             \includegraphics[width=\textwidth]{figures/sel/dedx5_pdf_skew_smooth.eps}
             \caption{Smoothed energy}
             \label{subfig:esc-smooth-e}
        \end{subfigure}
        \begin{subfigure}[b]{\dbfigwid\textwidth}
             \centering
             \includegraphics[width=\textwidth]{figures/sel/an_dedx5_pdf_skew_smooth_angnorm.eps}
             \caption{Angle-normalized smoothed energy}
             \label{subfig:esc-an-smooth-e}
        \end{subfigure}
        \caption{$\dedx$ estimation. Each colour represents a proton sample going in different directions. Each line style represents a different node from the end of the track. Altogether, there are 5 samples, each plotting for 4 nodes, resulting in 20 curves. Due to the large number of curves, the legend is omitted. The individual differences between the curves are not of interest here, but rather the overall agreement of the MIP peak positions across all curves can validate the quality of the estimation of $\dedx$. Fig.~\ref{sub:esc-smooth-e} shows considerable spread in the MIP peak positions across different curves, while the MIP peak positions in Fig.~\ref{sub:esc-an-smooth-e} are much closer across different curves. Therefore, the angle-normalized smoothed energy is a better estimate of $\dedx$ than the smoothed energy.}
        \label{fig:esc-angnorm}
     \end{figure}
     However, there are still some discrepancies.
     The MIP peaks are close to each other, but their positions differ noticeably.
     This is due to the different grouping of hits into nodes for protons travelling in different directions.
     The different numbers of hits in a node lead to different distances between nodes, so using the smoothed energy deposited per node as an estimation of $\dedx$ is not strictly valid.
     To account for the different propagation directions, I divided the energy by the sine of the angle between the trajectory and the $z$-axis.
     The angle-normalized energy is plotted in Fig.~\ref{subfig:esc-an-smooth-e}, which demonstrates that the angle-normalization step has achieved its goal—all MIP peaks have the similar position.
     Hence, the angle-normalized energy is used as a good reconstruction of $\dedx$ for the ESC selection, and it will be referred to as $\dedx$ in the following discussion.

     While the MIP peaks serve as a validation of the quality of the $\dedx$ estimation, the Bragg peaks are used to determine specific $\dedx$ thresholds for the ESC selection.
     To have a larger sample for threshold determination, the multiple PGUN samples are combined into one large sample.
     While plots like Fig.~\ref{fig:dedx-pprres-eg} show the underlying idea of the ESC selection, profile plots are better suited for determining proper thresholds.
     Hence, the profile plots of $\dedx$ for the last six nodes at the end of the proton track are collected in Fig.~\ref{fig:esc-andedx-slice}.
     To simplify the discussion, the $\dedx$ at the last node is referred to as $\dedx_1$, the second last node as $\dedx_2$, and so on, up to the sixth last node as $\dedx_6$.
     For example, Fig.~\ref{subfig:ans-dedx0-ppr-slice} shows considerably larger fluctuations in reconstruction quality when $\dedx_1$ falls below $200$, where a cut should be placed to exclude these events.
     Similarly, the threshold values from $\dedx_2$ to $\dedx_6$ are extracted to be $500$, $1000$, $900$, $840$, and $740$ respectively.

  \begin{figure}[t]
      \centering
      \begin{subfigure}{\dbfigwid\textwidth}
          %  \includegraphics[width=\textwidth]{figures/sel/ans_dedx0_vs_p_pr_res_hist2d_al2_selpr_con_slice.eps}
           \includegraphics[width=\textwidth]{figures/sel/fig53a.eps}
           \caption{$\dedx_1$, considerably larger fluctuations in reconstruction quality when $\dedx_1$ falls below $200$.}
           \label{subfig:ans-dedx0-ppr-slice}
      \end{subfigure}
      \begin{subfigure}{\dbfigwid\textwidth}
          %  \includegraphics[width=\textwidth]{figures/sel/ans_dedx1_vs_p_pr_res_hist2d_al2_selpr_con_slice.eps}
           \includegraphics[width=\textwidth]{figures/sel/fig53b.eps}
           \caption{$\dedx_2$, considerably larger fluctuations in reconstruction quality when $\dedx_2$ falls below $500$.}
           \label{subfig:dedx1}
      \end{subfigure}
      \\
      \begin{subfigure}{\dbfigwid\textwidth}
           \includegraphics[width=\textwidth]{figures/sel/fig53c.eps}
          %  \includegraphics[width=\textwidth]{figures/sel/ans_dedx2_vs_p_pr_res_hist2d_al2_selpr_con_slice.eps}
           \caption{$\dedx_3$, considerably larger fluctuations in reconstruction quality when $\dedx_3$ falls below $1000$.}
           \label{subfig:dedx2}
      \end{subfigure}
      \begin{subfigure}{\dbfigwid\textwidth}
          %  \includegraphics[width=\textwidth]{figures/sel/ans_dedx3_vs_p_pr_res_hist2d_al2_selpr_con_slice.eps}
           \includegraphics[width=\textwidth]{figures/sel/fig53d.eps}
           \caption{$\dedx_4$, considerably larger fluctuations in reconstruction quality when $\dedx_4$ falls below $900$.}
           \label{subfig:dedx3}
      \end{subfigure}
      \\
      \begin{subfigure}{\dbfigwid\textwidth}
          %  \includegraphics[width=\textwidth]{figures/sel/ans_dedx4_vs_p_pr_res_hist2d_al2_selpr_con_slice.eps}
           \includegraphics[width=\textwidth]{figures/sel/fig53e.eps}
           \caption{$\dedx_5$, considerably larger fluctuations in reconstruction quality when $\dedx_5$ falls below $840$.}
           \label{subfig:dedx4}
      \end{subfigure}
      \begin{subfigure}{\dbfigwid\textwidth}
          %  \includegraphics[width=\textwidth]{figures/sel/ans_dedx5_vs_p_pr_res_hist2d_al2_selpr_con_slice.eps}
           \includegraphics[width=\textwidth]{figures/sel/fig53f.eps}
           \caption{$\dedx_6$, considerably larger fluctuations in reconstruction quality when $\dedx_6$ falls below $740$.}
           \label{subfig:dedx5}
      \end{subfigure}
      \caption{Proton momentum reconstruction fractional difference against $\dedx$ for determination of $\dedx$ thresholds.}
      \label{fig:esc-andedx-slice}
  \end{figure}

     Furthermore, based on the $6$ distributions of $\dedx$, the average Bragg peak profile can be obtained by fitting the peaks of these distributions.
     Fig.~\ref{fig:esc-andedx-peaks} shows the $\dedx$ distributions for the last six nodes of the proton track.
     The specific $\dedx$ values constituting the Bragg peak are extracted by fitting the distributions with a Cauchy function near the peak region.
     Note that the fit is used to extract the peak value, not to model the entire distribution, so the fit quality is not of primary concern.
     From $\dedx_1$ to $\dedx_6$, the fitted Bragg peak values are $989.5$, $1080$, $1234$, $1131$, $990.0$, and $887.2$, respectively.

  \begin{figure}[t]
    \centering
    \begin{subfigure}{\dbfigwid\textwidth}
     %     \includegraphics[width=\textwidth]{figures/sel/ans_dedx0_pdf_al2_selpr_con_test.eps}
         \includegraphics[width=\textwidth]{figures/sel/fig54a.eps}
         \caption{$\dedx_1$ Bragg peak value fit. The fitted peak value is $989.5$.}
         \label{subfig:dedx0-peak}
    \end{subfigure}
    \begin{subfigure}{\dbfigwid\textwidth}
     %     \includegraphics[width=\textwidth]{figures/sel/ans_dedx1_pdf_al2_selpr_con_test.eps}
         \includegraphics[width=\textwidth]{figures/sel/fig54b.eps}
         \caption{$\dedx_2$ Bragg peak value fit. The fitted peak value is $1080$.}
         \label{subfig:dedx1-peak}
    \end{subfigure}
    \\
    \begin{subfigure}{\dbfigwid\textwidth}
     %     \includegraphics[width=\textwidth]{figures/sel/ans_dedx2_pdf_al2_selpr_con_test.eps}
         \includegraphics[width=\textwidth]{figures/sel/fig54c.eps}
         \caption{$\dedx_3$ Bragg peak value fit. The fitted peak value is $1234$.}
         \label{subfig:dedx2-peak}
    \end{subfigure}
    \begin{subfigure}{\dbfigwid\textwidth}
     %     \includegraphics[width=\textwidth]{figures/sel/ans_dedx3_pdf_al2_selpr_con_test.eps}
         \includegraphics[width=\textwidth]{figures/sel/fig54d.eps}
         \caption{$\dedx_4$ Bragg peak value fit. The fitted peak value is $1131$.}
         \label{subfig:dedx3-peak}
    \end{subfigure}
    \\
    \begin{subfigure}{\dbfigwid\textwidth}
     %     \includegraphics[width=\textwidth]{figures/sel/ans_dedx4_pdf_al2_selpr_con_test.eps}
         \includegraphics[width=\textwidth]{figures/sel/fig54e.eps}
         \caption{$\dedx_5$ Bragg peak value fit. The fitted peak value is $990.0$.}
         \label{subfig:dedx4-peak}
    \end{subfigure}
    \begin{subfigure}{\dbfigwid\textwidth}
     %     \includegraphics[width=\textwidth]{figures/sel/ans_dedx5_pdf_al2_selpr_con_test.eps}
         \includegraphics[width=\textwidth]{figures/sel/fig54f.eps}
         \caption{$\dedx_6$ Bragg peak value fit. The fitted peak value is $887.2$.}
         \label{subfig:dedx5-peak}
    \end{subfigure}
    \caption{Cauchy fits to extract the peak values of $\dedx$ at each node to estimate the average Bragg peak values.}
    \label{fig:esc-andedx-peaks}
  \end{figure}

     The $\dedx$ for the last six nodes for each track can then be compared with this average profile using a $\chi^2$,
    \begin{equation}
    \chi^2 = \sum_{i=1}^{6} \frac{(\dedx_i - \overline{\dedx_i})^2}{\overline{\dedx_i}}
    \end{equation}
    A proton coming to rest should have a similar profile, so an upper cut on $\chi^2$ could further select protons with good momentum resolution. 
    Similar to the determination of the threshold for the individual $\dedx$, the momentum fractional difference is plotted against $\chi^2$, as shown in Fig.~\ref{fig:esc-mom-res-chi2}.
    \begin{figure}[h]
       \centering
     %   \includegraphics[width=\sgfidwid\textwidth]{figures/sel/brchi2_colnor_vs_p_pr_res_hist2d_al2_selpr_con_test.eps} 
       \includegraphics[width=\sgfidwid\textwidth]{figures/sel/fig55.eps} 
       \caption{Proton momentum reconstruction fractional difference against $\chi^2$ for determination of $\chi^2$ thresholds. Considerably larger fluctuations in reconstruction quality when $\chi^2$ is above $800$.}
       \label{fig:esc-mom-res-chi2}
    \end{figure}
    The upper cut on $\chi^2$ is implemented at $800$, above which considerably larger fluctuations are observed.

    \subsection{Momentum reconstruction bias assessment}
    \label{sec:sel-esc-bias}
     In Ref.~\cite{Lu:2016mjf}, reconstruction bias in the transverse component of the momentum is observed after the ESC implementation.
     Hence, such bias is also checked for the signal sample in SFGD.
     However, unlike in Ref.~\cite{Lu:2016mjf}, no apparent bias in proton momentum reconstruction is present, while such bias is observed in muon momentum reconstruction as shown in Fig.~\ref{fig:esc-prmupt}.

     \begin{figure}
     \centering
     \begin{subfigure}[b]{\dbfigwid\textwidth}
          \centering
          \includegraphics[width=\textwidth]{figures/sel/pr_pt_vs_pr_pt_bias_hist2d_al14.eps}
          \caption{Ratio of true$/$reco for proton $p_T$ against proton $\pt$.}
          \label{subfig:esc-prpt}
     \end{subfigure}
     \begin{subfigure}[b]{\dbfigwid\textwidth}
          \centering
          \includegraphics[width=\textwidth]{figures/sel/mu_pt_vs_mu_pt_bias_hist2d_al14.eps}
          \caption{Ratio of true$/$reco for muon $p_T$ against muon $\pt$.}
          \label{subfig:esc-mupt}
     \end{subfigure}
     \caption{Momentum Reconstruction Bias Assessment}
     \label{fig:esc-prmupt}
     \end{figure}

     Further investigation shows that there is no bias in the muon angle, as shown in Fig.~\ref{subfig:esc-mutheta}.
     Additionally, such bias is shown to be present even before the implementation of the ESC step in Fig.~\ref{subfig:esc-mupt-bfesc}, while there is no appreciable bias in the full muon momentum reconstruction.
     This could be due to a bias in the neutrino direction reconstruction.
     However, such a direction bias should have affected the proton transverse momentum as well.
     As the impact is not pronounced and the simulation software is not the final stable version yet, a correction is done solely on the muon transverse momentum for the calculations of TKI variables, and further investigations on the root cause for this bias should be carried out after a stable simulation software version becomes available.

     \begin{figure}
     \centering
     \begin{subfigure}[b]{\dbfigwid\textwidth}
          \centering
          \includegraphics[width=\textwidth]{figures/sel/theta_mu_vs_theta_mu_res_hist2d_al14.eps}
          \caption{Value of true$-$reco for $\tmu$ against $\tmu$ before ESC.}
          \label{subfig:esc-mutheta}
     \end{subfigure}
     \begin{subfigure}[b]{\dbfigwid\textwidth}
          \centering
          \includegraphics[width=\textwidth]{figures/sel/mu_pt_vs_mu_pt_bias_hist2d_al13.eps}
          \caption{Ratio of true$/$reco for muon $p_T$ against muon $\pt$ before ESC.}
          \label{subfig:esc-mupt-bfesc}
     \end{subfigure}
     \caption{Muon Momentum Reconstruction Bias Assessment}
     \label{fig:esc-muptcor}
     \end{figure}

     The muon correction is applied through the inverse of the linear fit of the bias region between $0.5~\gevc$ and $1.1~\gevc$.
     The corrected muon transverse momentum is shown in Fig.~\ref{fig:esc-cormupt}, which demonstrates that the bias has been rectified.

     \begin{figure}[h]
     \centering
     \includegraphics[width=\sgfidwid\textwidth]{figures/sel/mu_pt_vs_cor_mu_pt_bias_hist2d_al14.eps} 
     \caption{Ratio of true$/$reco for muon $p_T$ against muon $\pt$ after correction.}
     \label{fig:esc-cormupt}
     \end{figure}

    \subsection{Impacts on Single Particle Kinematics}
     The ESC technique is completed with the transverse momentum bias correction.
     The overall impact of the technique on the reconstructed single particle kinematics (SPK), i.e. reconstructed proton kinematics in this case, is shown in Fig.~\ref{fig:esc-spk}.
     It has significantly reduced off-diagonal entries, which represent badly reconstructed events.
     Moreover, the conspicuous line with a negative slope in the $\tpr$ has mostly disappeared.
     These could be due to a mis-reconstruction of the track direction for short protons, which are excluded by the first requirement of the ESC step: the number of nodes has to be at least $6$.
     
     \begin{figure}
        \centering
        \begin{subfigure}[b]{\dbfigwid\textwidth}
             \centering
             \includegraphics[width=\textwidth]{figures/sel/p_pr_colnor_resmat_al13.eps}
             \caption{$\ppr$ before ESC selection.}
             \label{subfig:esc-ppr-bfesc}
        \end{subfigure}
        \begin{subfigure}[b]{\dbfigwid\textwidth}
             \centering
             \includegraphics[width=\textwidth]{figures/sel/theta_pr_colnor_resmat_al13.eps}
             \caption{$\tpr$ before ESC selection.}
             \label{subfig:esc-tpr-bfesc}
        \end{subfigure}
        \\
        \begin{subfigure}[b]{\dbfigwid\textwidth}
             \centering
             \includegraphics[width=\textwidth]{figures/sel/p_pr_colnor_resmat_al14.eps}
             \caption{$\ppr$ after ESC selection.}
             \label{subfig:esc-ppr-afesc}
        \end{subfigure}
        \begin{subfigure}[b]{\dbfigwid\textwidth}
             \centering
             \includegraphics[width=\textwidth]{figures/sel/theta_pr_colnor_resmat_al14.eps}
             \caption{$\tpr$ after ESC selection.}
             \label{subfig:esc-tpr-afesc}
        \end{subfigure}
        \caption{Reconstruction quality plots of truth against reconstruction values for SPK variables before (top) and after (bottom) selection. A significant reduction in the off-diagonal entries for both $\ppr$ and $tpi$ is observed after the ESC selection, indicating a better reconstruction quality. The conspicuous line with a negative slope for $\tpr$ has mostly disappeared.}
        \label{fig:esc-spk}
  \end{figure}

     The overall improvement in the SPK is best illustrated with a Cauchy fit to the proton momentum reconstruction resolution histogram, as shown in Fig.~\ref{subfig:ppr-res-bfESC} and Fig.~\ref{subfig:ppr-res-afESC}, which shows a more than $50\%$ reduction in the fitted half width at half maximum (HWHM) of the distribution.
     This improvement is achieved at the cost of a two-thirds reduction in efficiency, as shown in Fig.~\ref{subfig:ppr-eff-bfESC} and Fig.~\ref{subfig:ppr-eff-afESC}.
     The drop in efficiency might seem drastic, but it proves to be necessary for the TKI analysis, as shown later in Sec.~\ref{sec:mc-tki}, which showcases the significant improvement in the evaluation of TKI variables due to the ESC technique.

   \begin{figure}[t]
      \centering
      \begin{subfigure}{\dbfigwid\textwidth}
           \includegraphics[width=\textwidth]{figures/sel/p_pr_res_pdf_al13_zoom.eps}
           \caption{$\pp$ resolution before ESC selection. The fitted HWHM is about $3.5\%$.}
           \label{subfig:ppr-res-bfESC}
      \end{subfigure}
      \begin{subfigure}{\dbfigwid\textwidth}
           \includegraphics[width=\textwidth]{figures/sel/p_pr_eff_al13.png}
           \caption{Selection efficiency before ESC selection. The overall efficiency is $2113/8182\approx25.8\%$.}
           \label{subfig:ppr-eff-bfESC}
      \end{subfigure}
      \\
      \begin{subfigure}{\dbfigwid\textwidth}
           \includegraphics[width=\textwidth]{figures/sel/p_pr_res_pdf_al14_zoom.eps}
           \caption{$\ppr$ resolution after ESC selection. The fitted half width is about $1.6\%$.}
           \label{subfig:ppr-res-afESC}
      \end{subfigure}
      \begin{subfigure}{\dbfigwid\textwidth}
           \includegraphics[width=\textwidth]{figures/sel/p_pr_eff_al14.png}
           \caption{Selection efficiency after ESC selection. The overall efficiency is $736/8182\approx9.0\%$}
           \label{subfig:ppr-eff-afESC}
      \end{subfigure}
      \caption{Proton ESC selection results. The grey histograms are the true probability distribution, while the pink ones are those that get reconstructed. The selection efficiency has dropped from $25.8\%$ to $9.0\%$, while the proton momentum reconstruction resolution has improved from a fitted HWHM of $3.5\%$ to $1.6\%$.}
      \label{fig:esc-ppr-reseff}
   \end{figure}


    %------------------- pion TL ----------------%
    \section{Pion Trackless Reconstruction}
       \label{sec:sel-tl}
          As briefly elaborated in Sec.~\ref{sec:t2k-sw}, in SFGD, particle identification and momentum reconstruction are only performed on reconstructed tracks, which have a minimum length of about $30$~mm. 
          Hence, low-momentum particles, which travel only a short distance, could not be reconstructed at all. 
          When these low-momentum pions are not reconstructed, these $\ccopi$ events are misidentified as $\cczpi$ events, both decreasing the signal for the $\ccopi$ samples and increasing the background for the $\cczpi$ sample. 
          Thus, it would be highly beneficial if we could reconstruct these pions. 
          The pion trackless reconstruction technique I have developed can address this gap well.

          \subsection{Working Principles}
          \label{sec:tl-wp}
          The trackless technique is an advancement of previous methods. 
          It was first attempted in MINER$\nu$A~\cite{poster:minerva-pime} and in the Fine Grain Detectors of ND280~\cite{poster:minerva-pime}. 
          In MINER$\nu$A, a reconstructed cluster must be identified as a pion candidate. 
          In contrast, ND280 includes a prototype of the trackless reconstruction; however, it is integrated with other pion reconstruction methods, and its full potential has not yet been explored.

          This reconstruction technique is based on two key aspects of the pion decay chain, $\pi \rightarrow \mu \rightarrow e$:

          \begin{enumerate}
          \item \textbf{Delayed Michel Electron (ME) Signal:} The ME, as the grandchild in the decay chain, produces a delayed signal that occurs on a much longer timescale compared to other processes, such as $\piz$ decay. 
          Consequently, the presence of the primary pion can be inferred from the delayed ME signal in the SFGD.
          
          \item \textbf{Kinematic Determination via Energy-Momentum Conservation:} The pion decay, $\pi \rightarrow \mu + \nu$, is a two-body process. 
          The kinematics of the daughter particles are entirely determined by energy-momentum conservation. 
          When a pion decays at rest, the daughter muon moves only about $0.12~\textrm{cm}$. 
          Therefore, the starting point of the ME provides a reliable estimate of the pion's endpoint.
          \end{enumerate}

          Using the distance between the primary neutrino interaction vertex and the ME starting point, the pion momentum can be reconstructed by range. 
          Note that the pion must decay at rest for this technique to be applicable. 
          For pions that undergo secondary interactions, their range does not correlate with their momentum, so their momentum cannot be reconstructed by range.
          For a pion decaying in flight, its daughter muon will have a non-negligible momentum and hence travel an appreciable distance before decaying into the ME.
          Hence, the ME starting point is no longer a good estimate of the pion's endpoint.
          Alternatively, the muon starting point can be used to estimate the pion's  endpoint, but the range of the pion does not correlate with the pion starting momentum well as the ending momentum is non-zero.
          It might be possible to reconstruct the pion's ending momentum from the muon momentum due to the two-body decay kinematics, and then to reconstruct the pion's starting momentum from the pion's range and its ending momentum.
          This will be an interesting avenue to explore in the future, while the current analysis focuses on pions decaying at rest.

          For these target pions, an empirical relationship between the pion's kinetic energy and its range was established using a PGUN sample, as shown in Fig.~\ref{fig:pi-mombr-fit}. 
          The PGUN sample initiates pions from the centre of SFGD and propagates them isotropically. 
          It comprises $500,000$ events with kinetic energies uniformly distributed between $20~\mev$ and $200~\mev$. 
          The $\log_{10}$ of the true kinetic energy is plotted against the true pion length in Fig.~\ref{fig:pi-mombr-fit}.
          The central region of the plots is fitted with a fourth-order polynomial.
          Although the $\chindf$ of the fit is relatively large, the fitted line matches the data points well.
          Since the simulation is not yet final, this fit is sufficient for the current analysis and should be updated once the simulation is finalized.
          \begin{figure}[h]
          \centering
          \includegraphics[width=\sgfidwid\textwidth]{figures/sel/pi_len_pi_len_vs_pi_ke_hist2d_al0_true_nokink.eps} 
          \caption{A degree 4 polynomial fit of $\log_{10}{T_\pi}$ against $\log_{10}{L_\pi}$, where $T_\pi$ and $L_\pi$ are the kinetic energy and the range of the pion, respectively. The $p_i$'s are the corresponding coefficients of the term of order $i$. The fit matches the data points well.}
          \label{fig:pi-mombr-fit}
          \end{figure}

       \subsection{Preliminary Study on Pion Fates}
       \label{sec:tl-ps}
          Before implementing the pion trackless reconstruction technique, it is essential to assess its potential significance, as this technique can only reconstruct pions that decay at rest. 
          If only a limited number of pions decay in this manner, the technique would be inapplicable. 
          Therefore, a preliminary study on pion fates relevant to T2K was conducted.

          The first step involved examining the primary pion momentum distribution in SFGD as produced by the T2K neutrino beam. 
          For a rough estimation, the first 100,000 events in the T2K input flux file were processed through the T2K ND simulation, and events containing a primary pion were recorded. 
          The true pion momentum cumulative distribution is shown in Fig.~\ref{subfig:pi-mom-cum}, indicating that the majority of pions have momentum below $1000~\mevc$.

          \begin{figure}[t]
               \centering
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/pion_mom_pdf.png}
                    \caption{Primary pion momentum cumulative distribution. The median momentum is about $300~\mevc$.}
                    \label{subfig:pi-mom-cum}
               \end{subfigure}
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/pion_theta_pdf.png}
                    \caption{Primary pion angle cumulative distribution. The $80\%$ angle is $87^\circ$.}
                    \label{subfig:pi-theta-cum}
               \end{subfigure}
               \caption{Cumulative density functions of Primary pion kinematics in SFGD.}
          \end{figure}
               
          The median momentum is approximately $300~\mevc$, with about $30\%$ of pions having momentum below $200~\mevc$ and $80\%$ below $800~\mevc$. 
          Similarly, the pion angle distribution, depicted in Fig.~\ref{subfig:pi-theta-cum}, shows that approximately $80\%$ of pions have an angle below $87^\circ$.

          The second step is to simulate pion propagation in SFGD with the relevant kinematics. 
          A total of six samples, each containing 10,000 events, were simulated with pions traveling at momenta of $200~\mevc$, $300~\mevc$, and $800~\mevc$, and angles of $0^\circ$ and $70^\circ$. 
          Since SFGD reconstruction is largely independent of pion direction, the $70^\circ$ samples serve as consistency checks. 
          For each sample, the fate of each pion was determined using the truth information.

          A total of ten fate topologies are defined as follows:
          \begin{enumerate}
          \item \textbf{DK@rest (Good)} – The pion decays at rest, and the total number of true trajectories is three, corresponding to $\pip$, $\mu$, and the ME exactly. 
          This represents a clean pion decay-at-rest event.
          \item \textbf{DK@rest (Dirty)} – Similar to the previous fate, but the total number of true trajectories exceeds three. 
          The additional trajectories are mostly electromagnetic showers due to the ME.
          \item \textbf{DK@flight} – The pion decays with non-zero momentum, resulting in a relatively large starting momentum for the daughter muon.
          \item \textbf{Elastic Knock-out} – The pion undergoes secondary interactions (SI), leading to the liberation of an additional proton. 
          The pion continues to propagate and decay, but its range is no longer well correlated with its starting momentum.
          \item \textbf{Deflection} – The pion undergoes SI. 
          No additional particles are produced, but its direction changes.
          \item \textbf{Absorption} – Another type of SI where the pion does not emerge from its interaction with the nucleus, so no ME is present.
          \item \textbf{Charge Exchange} – The $\pip$ is converted to a $\piz$ via a charge exchange interaction with the nucleus. 
          Since $\piz$ decays much faster, no ME is present.
          \item \textbf{$\pim$} – While there is no single interaction that can convert a $\pip$ to a $\pim$, this fate—where a $\pim$ appears as one of the daughters of the $\pip$—is observed, albeit rarely, due to complex pion SI within the nucleus.
          \item \textbf{Escaped} – The pion escapes SFGD before decaying. 
          Regardless of its subsequent decay, the potential ME cannot be detected in SFGD.
          \item \textbf{Others} – This category includes all uncategorised events, such as cases where the pion produces delta ray electrons or undergoes bremsstrahlung. 
          These events are relatively rare and do not require special treatment.
          \end{enumerate}

          Fates 1 through 3 involve pions that decay before any secondary interactions, i.e., pions decay via the chain $\pi \rightarrow \mu \rightarrow e$. 
          Thus, these pions can be tagged by the presence of the ME. 
          However, as illustrated in Sec.~\ref{sec:tl-wp}, the trackless technique relies on the extremely short distance travelled by the daughter muon. 
          Pions decaying in flight result in a longer distance travelled by the daughter muon, making them unsuitable for the trackless technique.

          Fates 4 through 8 involve pions that undergo secondary interactions, resulting in the absence of the ME, except for those that experience deflection, which also renders them unsuitable for the trackless technique. 
          The range of a deflected pion does not correlate well with its momentum, further disqualifying it from being reconstructed by the trackless technique. 
          In summary, the trackless technique is most applicable to Fates 1 and 2.

          The fate distributions are shown in Fig.~\ref{fig:pi-fate}. 
          For the $200~\mevc$ samples, both at $0^\circ$ and $70^\circ$, more than $70\%$ of the pions fall into Fates 1 and 2. 
          In the $300~\mevc$ samples, this fraction drops to $30\%$ for the $0^\circ$ angle and about $12\%$ for the $70^\circ$ angle. 
          This trend is expected because as pion momentum increases, the decay length increases, and the probability of secondary interactions rises. 
          The further decrease observed at $70^\circ$ is attributed to an increased escape fraction. 
          The geometry of SFGD, being much shorter in the vertical direction, facilitates the escape of high-angle pions. 
          For $800~\mevc$ pions, the decay length is too long for SFGD, resulting in a significant increase in the escape fraction—approximately $30\%$ at $0^\circ$ and $50\%$ at $70^\circ$. 
          The unescaped pions are those that have undergone secondary interactions, rendering them not reconstructable by the trackless technique at this high momentum.

          \begin{figure}[t]
               \centering
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/pion_fate_200_0.png}
                    \caption{$\ppi=200\mevc$ and $\tpi=0^\circ$.}
                    \label{subfig:pi-fate-200-0}
               \end{subfigure}
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/pion_fate_200_70.png}
                    \caption{$\ppi=200\mevc$ and $\tpi=70^\circ$.}
                    \label{subfig:pi-fate-200-70}
               \end{subfigure}
              \\
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/pion_fate_300_0.png}
                    \caption{$\ppi=300\mevc$ and $\tpi=0^\circ$.}
                    \label{subfig:pi-fate-300-0}
               \end{subfigure}
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/pion_fate_300_70.png}
                    \caption{$\ppi=300\mevc$ and $\tpi=70^\circ$.}
                    \label{subfig:pi-fate-300-70}
               \end{subfigure}
              \\
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/pion_fate_800_0.png}
                    \caption{$\ppi=800\mevc$ and $\tpi=0^\circ$.}
                    \label{subfig:pi-fate-800-0}
               \end{subfigure}
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/pion_fate_800_70.png}
                    \caption{$\ppi=800\mevc$ and $\tpi=70^\circ$.}
                    \label{subfig:pi-fate-800-70}
               \end{subfigure}
               \caption{Pion fates in the SFGD for different combinations of pion kinematics}
               \label{fig:pi-fate}
            \end{figure}
       
          This preliminary study demonstrates that a considerable fraction of the primary pions produced in SFGD have relatively low momentum ($<200~\mevc$). 
          For these pions, the majority decay at rest, producing an ME that can be utilized in the trackless technique. 
          Thus, the trackless technique is applicable to approximately $30\%$ of the total pion events in SFGD, making it a significant reconstruction method to develop.


     \subsection{Implementation}
     \label{sec:tl-imp}
          The pion trackless reconstruction is integrated into my $\numuccopi$ selection, which builds upon the existing $\numucc$-inclusive selection. 
          Therefore, it is appropriate to discuss the trackless technique within the context of the $\numuccopi$ selection.

          The $\numucc$-inclusive selection identifies the primary vertex position and the primary muon, providing the trackless reconstruction with a reliable approximation of the pion's starting point. 
          The following steps are implemented to identify suitable ME candidates and reconstruct the pion momentum in the $\numuccopi$ selection:
          \begin{itemize}
          \item \textbf{Step 0 - $\numucc$-inclusive Selection}
          \item \textbf{Step 1 - Find Suitable ME Candidates}
          \item \textbf{Step 2 - One Trackless Pion Cut}
          \item \textbf{Step 3 - Kink Cut}
          \item \textbf{Step 4 - Background Reduction}
          \end{itemize}
          \textbf{Find Suitable ME Candidates} – Iterate through all delayed reconstructed objects with more than one hit. 
          If an object occurs $30.0~\textrm{ns}$ after the primary vertex time, it is saved as a potential ME candidate. 
          However, ME candidates may trigger showers, resulting in additional delayed reconstructed objects. 
          To distinguish the true ME from these secondary objects, the "prompt energy" technique used by MINERvA~\cite{Zhang:2016glf} is employed. 
          Prompt energy refers to the energy deposited by the short muon and pion. 
          Although these particles may have insufficient energy to form a reconstructable track, they still deposit energy much earlier than the ME onset. 
          Therefore, by examining the energy deposition within $30~\textrm{mm}$ around both ends of an ME candidate, it can be determined if energy was deposited $30~\textrm{ns}$ prior, confirming the suitability of the ME candidate. 
          Additionally, if the primary muon is contained within SFGD, it may also decay and produce an indistinguishable ME based solely on time delay. 
          To address this, an additional check excludes ME candidates near the end of the identified primary muon.

          \textbf{One Trackless Pion Cut} – Select events that have exactly one proper ME candidate.

          \textbf{Kink Cut} – Since the trackless reconstruction does not require the ME to be adjacent to a primary track, it cannot differentiate pions travelling directly from the primary interaction to decay at rest from those that have been deflected before decaying at rest. 
          To ensure accurate momentum-by-range reconstruction, events with deflected pions are rejected. 
          Specifically, any event with an ME connected to non-primary tracks is excluded.

          \textbf{Background Reduction} – Multiple background reduction steps are implemented, including an existing $\pi^0$ rejection developed by colleagues at T2K. 
          However, these measures are insufficient, as evidenced by the significant portion of CC-other backgrounds in Figs.~\ref{subfig:tlpi-ppi-bf-trknumcut-tpc}, \ref{subfig:tlpi-tpi-bf-trknumcut-tpc}, \ref{subfig:tlpi-ppi-bf-trknumcut-sfg}, and \ref{subfig:tlpi-tpi-bf-trknumcut-sfg}. 
          Therefore, based on a logical understanding of different event topologies, I developed a series of track number cuts and introduced a new concept called the "track family tree."

          An event topology resembles a family tree sideways. 
          The first generation consists of the primary tracks, while the second generation includes tracks connected to the ends of the primary tracks. 
          The family tree tracing step involves looping through all reconstructed tracks to build the family tree starting from the primary vertex. 
          One useful variable is the number of generations. 
          A $\numuccopi$ event should not have a large number of generations, as the primary pion can have an ME attached to its end without producing showers or multiple scatterings. 
          Therefore, the number of generations is required to be fewer than three. 
          Another associated variable is the number of lone tracks, which are not connected to any tracks in the family tree. 
          A clean $\numuccopi$ event should have a limited number of lone tracks, which could result from noise or low-energy scattering of the ME, leading to clusters isolated from the ME track. 
          Further details on the other track number cuts are provided in Appendix.~\ref{sec:app-tlpi-trknumcut}. 
          The overall impact of the track number cuts is illustrated by the topological decomposition of the pion kinematic distributions in Fig.~\ref{fig:tl-trknum-cut-res}.

            \begin{figure}
               \centering
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/TPCmu_p_pi_stack_al8.eps}
                    \caption{TPC-$\mu$: $\ppi$ before track number cut.}
                    \label{subfig:tlpi-ppi-bf-trknumcut-tpc}
               \end{subfigure}
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/TPCmu_theta_pi_stack_al8.eps}
                    \caption{TPC-$\mu$: $\tpi$ before track number cut.}
                    \label{subfig:tlpi-tpi-bf-trknumcut-tpc}
               \end{subfigure}
               \\
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/TPCmu_p_pi_stack_al9.eps}
                    \caption{TPC-$\mu$: $\ppi$ after track number cut.}
                    \label{subfig:tlpi-ppi-af-trknumcut-tpc}
               \end{subfigure}
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/TPCmu_theta_pi_stack_al9.eps}
                    \caption{TPC-$\mu$: $\tpi$ after track number cut.}
                    \label{subfig:tlpi-tpi-af-trknumcut-tpc}
               \end{subfigure}
               \\
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/SFGmu_p_pi_stack_al8.eps}
                    \caption{SFGD-$\mu$: $\ppi$ before track number cut.}
                    \label{subfig:tlpi-ppi-bf-trknumcut-sfg}
               \end{subfigure}
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/SFGmu_theta_pi_stack_al8.eps}
                    \caption{SFGD-$\mu$: $\tpi$ before track number cut.}
                    \label{subfig:tlpi-tpi-bf-trknumcut-sfg}
               \end{subfigure}
               \\
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/SFGmu_p_pi_stack_al9.eps}
                    \caption{SFGD-$\mu$: $\ppi$ after track number cut.}
                    \label{subfig:tlpi-ppi-af-trknumcut-sfg}
               \end{subfigure}
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/SFGmu_theta_pi_stack_al9.eps}
                    \caption{SFGD-$\mu$: $\tpi$ after track number cut.}
                    \label{subfig:tlpi-tpi-af-trknumcut-sfg}
               \end{subfigure}
               \caption{Pion kinematics before and after track number cuts.}
               \label{fig:tl-trknum-cut-res}
          \end{figure}

          As shown in Figs.~\ref{subfig:tlpi-ppi-bf-trknumcut-tpc} and \ref{subfig:tlpi-ppi-af-trknumcut-tpc}, the purity of the $\numuccopi$ selection improved from $74.1\%$ to $87.5\%$ after applying the track number cuts for the TPC-$\mu$ sub-sample. 
          Similarly, Figs.~\ref{subfig:tlpi-ppi-bf-trknumcut-sfg} and \ref{subfig:tlpi-ppi-af-trknumcut-sfg} show an improvement in selection purity from $65.9\%$ to $80.7\%$. 
          Although the cuts result in an $18\%$ and $14\%$ decrease in the number of signal events, these results demonstrate that the track number cuts effectively remove backgrounds. 
          Since the HAT-$\mu$ sub-sample still suffers from a global matching problem, its results are not included here.

          For events passing all selection steps, the presence of a primary pion is inferred from the existence of a proper ME candidate, and its momentum is reconstructed by range. 
          A quick consistency check involves plotting the distribution of the time difference between the ME and the primary vertex, which should equal the pion travel time plus the muon decay time. 
          Since the pion travel time is on the order of nanoseconds, the resulting distribution should closely follow the muon exponential decay. 
          The distributions of the ME time delay for the TPC-$\mu$ and SFGD-$\mu$ sub-samples are shown in Fig.~\ref{fig:tlpi-me-td}.
          \begin{figure}
               \centering
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/SFGmu_ME_td_hist_al9_fit.eps}
                    \caption{SFGD-$\mu$. The fitted lifetime is $2226\pm67~\ns$.}
                    \label{subfig:tlpi-me-td-sfgmu}
               \end{subfigure}
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/TPCmu_ME_td_hist_al9_fit.eps}
                    \caption{TPC-$\mu$. The fitted lifetime is $2329\pm58~\ns$.}
                    \label{subfig:tlpi-me-td-tpcmu}
               \end{subfigure}
              \caption{Time difference between ME and the end point of the stopping pion track.}
               \label{fig:tlpi-me-td}
            \end{figure}
          \end{figure}

          Fig.~\ref{fig:cc1pi-tl} displays a candidate $\ccopi$ event passing the $\numuccopi$-TL selection in the upgraded ND280 during the beam run in June 2024. 
          The second-longest track is the ME, whose starting point is very close to that of the primary muon, indicating the extremely short distance traveled by the primary pion. 
          \begin{figure}[!htb] 	
               \centering 		
               \includegraphics[width=\sgfigwid\textwidth]{figures/shortPion.png}
               \caption{\label{fig:cc1pi-tl} A $\ccopi$-TL candidate event in upgraded ND280, where the long track is the primary muon and the other track is a delayed ME, which implies the existence of a very low momentum primary pion.} 
          \end{figure}
          This short distance makes reconstruction using a track-based method practically unfeasible.

     \subsection{Comparison with Conventional Method}
     \label{sec:comparison-conventional}

          One key advantage of the trackless technique is its improved reconstruction in the low-momentum phase space. 
          To verify this claim, I compared pion momentum reconstruction using the conventional method, where the pion is identified by a reconstructed track with an attached ME. 
          A preliminary selection based on the conventional method was developed for this comparison. 
          To differentiate between the two pion selections, the trackless technique selection is referred to as $\numuccopi$-TL, while the conventional method selection is referred to as $\numuccopi$-TR.

          The $\numuccopi$-TR selection is based on the $\numucc$-inclusive selection and employs the same background reduction steps as the $\numuccopi$-TL.
          The difference lies in the reconstruction of the primary pion.
          A reconstructed primary track with an attached ME is required.
          No further optimization is performed, ensuring that this selection encompasses the maximally possible phase space.
          The results of the comparison are shown in Fig.~\ref{fig:tltr-comp}\footnote{Note that the result for $\numuccopi$-TL in this figure does not include the implementation of the early energy deposit in choosing the suitable ME candidate, as this comparison was conducted during the early stage of development. 
          Since the main purpose of this comparison is to demonstrate the limitations of the conventional method, the final reconstruction threshold for the $\numuccopi$-TL is presented in Fig.~\ref{fig:piTLres}.}.
          The efficiencies for pions with momentum higher than $100~\mevc$ are similar for both methods.
          Below $100~\mevc$, the improvement brought by the trackless technique is twofold.
          Firstly, the efficiencies below $100~\mevc$ are significantly higher for the trackless technique.
          The efficiency for $\numuccopi$-TR drops drastically below $80~\mevc$.
          Secondly, the momentum threshold in $\numuccopi$-TL extends below $50~\mevc$, which is impossible for the conventional method.
          More encouragingly, this improvement in low momentum efficiency and lower threshold does not compromise selection purity, as shown in Figs.~\ref{subfig:stack-topo-tl} and \ref{subfig:stack-topo-tr}.

          \begin{figure}
               \centering
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/finhist_pi_mom_topology_TL.png}
                    \caption{$\numuccopi$-TL: Topology decomposition.}
                    \label{subfig:stack-topo-tl}
               \end{subfigure}
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/finhist_pi_mom_topology_TR.png}
                    \caption{$\numuccopi$-TL: Topology decomposition.}
                    \label{subfig:stack-topo-tr}
               \end{subfigure}
               \\
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/p_pi_eff_al10_TL.png}
                    \caption{$\numuccopi$-TL: Reconstruction efficiency.}
                    \label{subfig:ppi-eff-tl}
               \end{subfigure}
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/p_pi_eff_al9_TR.png}
                    \caption{$\numuccopi$-TR: Reconstruction efficiency.}
                    \label{subfig:ppi-eff-tr}
               \end{subfigure}
              \caption{Pion trackless reconstruction results.}
               \label{fig:tltr-comp}
            \end{figure}


     \subsection{Impacts on SPK}
          The results of the $\numuccopi$ selection using the trackless pion technique are summarized in Fig.~\ref{fig:piTLres}.
          As shown in Fig.~\ref{fig:ppi-stack}, the trackless selection has achieved its goal of reconstructing low-momentum pions.
          A considerable number of events contain pions with momentum below $100~\mevc$, corresponding to a track length of approximately $50~\textrm{mm}$.
          Moreover, pions with momentum below $80~\mevc$ have also been reconstructed; these pions travel about $30~\textrm{mm}$ and cannot be reconstructed as tracks.
          Furthermore, the momentum-by-range calculation has achieved an excellent HWHM of approximately $2\%$, as shown in Fig.~\ref{fig:ppi-res}.
          More encouragingly, the overall efficiencies remain relatively high.
          The step-by-step efficiencies for each selection step are shown in Fig.~\ref{fig:tl-accum-eff}.
          The signal definition used in the calculation requires one true muon that has travelled to the vertical TPC and one true pion that is contained in SFGD.
          Steps 1 to 7 correspond to the $\numucc$-inclusive selection.
          The large drop in efficiency at Step 8 is expected, as it requires exactly one pion to be reconstructed tracklessly.
          All pions undergoing secondary interactions, except for deflection, cannot be reconstructed via this method.
          Hence, the relative efficiency of $0.37/0.66\approx56\%$ is considerably high.
          A further significant drop in efficiency occurs in the next step, the kink cut, which is reasonable as a considerable portion of pions undergo deflection.
          The gradual drops are subsequent cuts to remove backgrounds, resulting in a high purity of $\numuccopi$, as shown in Fig.~\ref{fig:ppi-stack}.

          \begin{figure}[t]
              \centering
              \begin{subfigure}{\trfigwid\textwidth}
                   \includegraphics[width=\textwidth]{figures/sel/ppi_stack.png}
                   \caption{Momentum distribution.}
                   \label{fig:ppi-stack}
              \end{subfigure}
              \begin{subfigure}{\trfigwid\textwidth}
                   \includegraphics[width=\textwidth]{figures/sel/ppi_res.png}
                   \caption{Momentum resolution.}
                   \label{fig:ppi-res}
              \end{subfigure}
              \begin{subfigure}{\trfigwid\textwidth}
                   \includegraphics[width=\textwidth]{figures/sel/INCL_p_pi_accum_eff_al11.png}
                   \caption{Accumulative efficiency.}
                   \label{fig:tl-accum-eff}
              \end{subfigure}
              \caption{Pion trackless reconstruction results.}
              \label{fig:piTLres}
           \end{figure}


    \section{Development of stopping pion control sample}

          \subsection{Implementation}
          \label{sec:sppi-imp}
          Conventionally, selections are used for cross-section analysis, which requires a sufficient portion of all detector systematics to be correctly evaluated.
          However, due to time constraints, this is unlikely to happen within the timeframe of my doctoral study.
          Therefore, only preliminary data–MC comparisons are feasible.
          Nonetheless, because systematic evaluation is an important aspect of cross-section analysis—crucial for improving our understanding of neutrino–nucleus interactions—I implemented the propagation of the momentum-by-range reconstruction systematics for pions tagged by ME.
          To evaluate this systematic, I developed the stopping pion control sample with the following steps:
          \begin{enumerate}
          \item Find all tracks that contain an SFGD segment and segments in the other sub-detectors.
          \item Check that one end of this track is stopped in SFGD.
          \item Check the PID of this track provided by the other sub-detectors, i.e., HAT or TPC.
          \item Check that there are no other (except ME) near the track end in SFGD.
          \item A final cut requiring the presence of an ME near the track end in SFGD.
          \item Keep only the event with a single stopping pion candidate.
          \end{enumerate}
          The preliminary result suggests that the control sample consists predominantly of tracks passing HAT and stopping in SFGD, while there are few events propagating backwards from TPCs to SFGD.
          As the current PID in HAT is not fully developed but indispensable for the control sample development, I developed a temporary PID method for HAT for demonstration only. 
          The HAT PID method will need to be updated in the future with a sophisticated version developed by HAT experts, but the other steps can remain intact.

          As HAT has fundamentally the same working principle as the TPC, I followed closely the TPC PID method.
          Different particles can be distinguished by their specific energy loss, i.e. $\dedx$, along the tracks in the TPC.
          The expected $\dedx$ for a given type of particle, like a proton, at a given momentum can be obtained numerically.
          The measured $\dedx$ of a reconstructed track is compared with the expected $\dedx$ to determine the particle type.
          This comparison is quantified by the "pulls", which are conventionally defined as the difference between the measured and expected $\dedx$ divided by the uncertainty of the measurement.
          The existing TPC PID is based on the logarithms of the pulls. 
          In practice, this value is constructed such that the closer the value is to $1$, the more likely the particle is of the corresponding type.
          For subsequent discussion, this value will simply be referred to as the pull as well.

          There are four pulls for each reconstructed track, corresponding to the four particle types: muon, electron, proton, and pion.
          For the existing TPC PID, the pion pull was set to be larger than $0.3$ and the sum of the muon and the pion pull was set to be larger than $0.8$ for pion PID, due to the similarities between muons and pions.
          The distributions of the pulls at HAT for positively charged tracks before any cuts are shown in Fig.~\ref{fig:pulls}.
         % The TPC PID is based on the so-called "pulls", which essentially quantify the deviation
          % The logarithms of the first and the fourth elements of the pull vector are most relevant.
          % For conciseness, these logarithms are simply referred to as the first pull and the fourth pull, respectively.
          % Although HAT is also a TPC, there are design differences, so the PID requirement may differ.

          \begin{figure}
               \centering
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/sspi_TOP_hat_pid0_stack_al5.eps}
                    \caption{The muon pull.}
                    \label{subfig:sppi-pulls-1}
               \end{subfigure}
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/sspi_TOP_hat_pid1_stack_al5.eps}
                    \caption{The electron pull.}
                    \label{subfig:sppi-pulls-2}
               \end{subfigure}
               \\
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/sspi_TOP_hat_pid2_stack_al5.eps}
                    \caption{The proton pull.}
                    \label{subfig:sppi-pulls-3}
               \end{subfigure}
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/sspi_TOP_hat_pid3_stack_al5.eps}
                    \caption{The pion pull.}
                    \label{subfig:sppi-pulls-4}
               \end{subfigure}
               \caption{Pull distributions at HAT before any PID cuts for positive reconstructed tracks. Most pion tracks have large pion pulls, small electron pulls, and small proton pulls. However, a sizeable fraction of pions have non-negligible muon pulls, which can lead to a significant muon background in the stopping pion sample.}
               \label{fig:pulls}
          \end{figure}

          A significant fraction of pions possess considerably large muon pulls, which indicates that a significant fraction of muons will remain after the TPC pull cuts.
          Hence, stricter cuts are required to obtain a pion sample with higher purity.
          In particular, a direct upper on the muon pull is necessary.
          To determine the precise cut value, a further zoom of the first pull is shown in Fig.~\ref{fig:pull0-zoom}, suggesting a cut to exclude events with the muon pull larger than $0.04$.
          \begin{figure}
               \centering
               \includegraphics[width=\textwidth]{figures/sel/sspi_TOP_hat_pid0_stack_al5_zoom.eps}
               \caption{Zoom on the first pull distribution at HAT.}
               \label{fig:pull0-zoom}
          \end{figure}
          After the cut on the muon pull, the other pull distributions do not show a clear separation between the muon background and the pion signal, as illustrated in Fig.~\ref{fig:pulls-pid0}.
          \begin{figure}
               \centering
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/sspi_TOP_hat_pid0_stack_al5_pid0.eps}
                    \caption{The muon pull.}
                    \label{subfig:sppi-pulls-1-pid0}
               \end{subfigure}
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/sspi_TOP_hat_pid1_stack_al5_pid0.eps}
                    \caption{The electron pull.}
                    \label{subfig:sppi-pulls-2-pid0}
               \end{subfigure}
               \\
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/sspi_TOP_hat_pid3_stack_al5_pid0.eps}
                    \caption{The pion pull.}
                    \label{subfig:sppi-pulls-4-pid0}
               \end{subfigure}
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/sspi_TOP_trk_heavylen_stack_al5_pid0.eps}
                    \caption{Heavy length.}
                    \label{subfig:sppi-heavylen-pid0}
               \end{subfigure}
               \caption{Pull distributions and a distribution of heavy length at HAT after the cut on the muon pull.}
               \label{fig:pulls-pid0}
          \end{figure}

          Instead, I used a concept suggested by my colleague, Xingyu Zhao, from his FGD analysis, where he defined a variable called the heavy length—the portion of the particle inside a dense detector (e.g., SFGD).
          This length can distinguish between leptons and hadrons because hadrons are much more likely to interact with dense material, thereby having shorter lengths within such detectors.
          For the stopping pion sample, the heavy length is dominated by the portion in the SFGD, as the ECAL and TOF contribute only marginally.
          As shown in Fig.~\ref{subfig:sppi-heavylen-pid0}, a cut on the heavy length to keep events below $150~\mm$ can remove a considerable portion of the muon background remaining after the cut on the muon pull.

          The pull distributions shown are based on the sub-sample where the pion passes through the Top HAT.
          The Bottom HAT has similar performance, and the same cuts are applied.
          For brevity, the pull distributions for the Bottom HAT are collected in Sec.~\ref{sec:app-bot-pulls} in the Appendix.
          The final selection results for the two subsamples are shown in Fig.~\ref{fig:sppi-kin}.
          The Top HAT subsample has achieved a purity of $94.8\pm2.3\%$ as shown in Fig.~\ref{subfig:sppi-top-ppi} and Fig.~\ref{subfig:sppi-top-tpi}, which has $91$ $\pip$ signal events, $3$ $\mu^-$, and $2$ $\mu^+$ background events.
          Similarly, the Bottom HAT subsample has achieved a purity of $87.5\pm1.8\%$ as shown in Fig.~\ref{subfig:sppi-bot-ppi} and Fig.~\ref{subfig:sppi-bot-tpi}, which has $293$ $\pip$ signal events, $15$ $\mu^-$, $26$ $\mu^+$, and $1$ $\pim$ background event.

          \begin{figure}
               \centering
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/sspi_TOP_pi_mombr_stack_al6_zoom.eps}
                    \caption{Top HAT $\ppi$.}
                    \label{subfig:sppi-top-ppi}
               \end{subfigure}
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/sspi_TOP_theta_trk_stack_al6_zoom.eps}
                    \caption{Top HAT $\tpi$.}
                    \label{subfig:sppi-top-tpi}
               \end{subfigure}
               \\
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/sspi_BOT_pi_mombr_stack_al6_zoom.eps}
                    \caption{Bottom HAT $\ppi$.}
                    \label{subfig:sppi-bot-ppi}
               \end{subfigure}
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/sspi_BOT_theta_trk_stack_al6_zoom.eps}
                    \caption{Bottom HAT $\tpi$.}
                    \label{subfig:sppi-bot-tpi}
               \end{subfigure}
               \caption{Stopping pion kinematic distributions decomposed according to true particle type.}
               \label{fig:sppi-kin}
          \end{figure}

          % Because the HAT reconstruction is still under development, the values implemented here may be subject to further updates.
          As this HAT PID method is temporary, the achieved purity is sufficient to demonstrate the usage of the stopping pion sample for systematics evaluation.
          Before proceeding to systematics evaluation, a good consistency check of using the ME method to select the stopping pion is to check the time difference between the ME and the end point of the stopping track.
          This distribution should closely follow the muon exponential decay curve.
          The result is shown in Fig.~\ref{fig:sppi-me-td}.

          \begin{figure}
               \centering
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/sspi_TOP_ME_td_hist_al6_sfgfinposfit_comb.eps}
                    \caption{MC. The fitted lifetime is $2335\pm132~\ns$.}
                    \label{subfig:sppi-me-td-mc}
               \end{subfigure}
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/sspi_TOP_ME_td_hist_al6_sfgfinpos_fit.eps}
                    \caption{Data. The fitted lifetime is $2234\pm456~\ns$.}
                    \label{subfig:sppi-me-data}
               \end{subfigure}
               \caption{Time difference between ME and the end point of the stopping pion track. Both distributions follow the muon exponential decay curve, suggesting that the selected particles are likely stopping pions.}
               \label{fig:sppi-me-td}
          \end{figure}

          \subsection{Systematics evaluation}
          \label{sec:sppi-syst}
          The control sample is developed with evaluation of the pion momentum by range reconstruction in mind.
          Although the selection is not finalized as the HAT reconstruction and global track matching are still subjected to changes, it is still valuable to develop the systematics evaluation framework.
          One is to learn the method of performing systematics evaluation, the other is to get a first glimpse of the performance of the pion momentum reconstruction in SFGD.

          The systematics evaluation follows that in the FGD analysis as outlined in Ref.~\cite{Jenkins:2022ljx}.
          While it is straightforward to examine the reconstruction resolution with MC studies, there is no truth information when analysing data.
          As the momentum reconstruction in TPCs has good resolution and is well validated, i.e. there is good agreement between MC and data, instead of comparing the reconstructed momentum to the true momentum, it can be used as a good estimation of the true momentum.
          Moreover, as the control sample selects pion tracks that travel from HAT into SFGD and the pion loses an infinitesimal amount of energy in the HAT, the momentum obtained from the HAT reconstruction is a good approximation of the true enter momentum in SFGD.
          The deviations of the SFGD reconstructed momentum from the HAT reconstructed momentum can be computed for both MC and data.
          On one hand, this deviation can be regarded as an approximation of the SFGD momentum resolution.
          On the other hand, the difference between the deviations of MC and data can assess the difference in the reconstruction performance between MC and data in SFGD, i.e. the systematics related to the SFGD momentum by range reconstruction.

          The distributions of the deviations for MC and data are shown in Fig.~\ref{fig:sppi-res} and the fitting parameters, the mean ($x_0$) and the HWHM ($\gamma$), are summarised in Table.~\ref{tab:sppi-res}.
          Both widths are significantly smaller than those in the FGD analysis presented in Ref.~\cite{Jenkins:2022ljx}, in the FGD study.
          However, due to the low data statistics, the numerical results here are for illustration only, and a more reliable evaluation of the reduction in the pion momentum-by-range reconstruction systematic error will be performed when the HAT reconstruction is finalized and more data are collected.
          \begin{figure}[h]
          \centering
          \begin{subfigure}[h]{\dbfigwid\textwidth}
          \centering
          \includegraphics[width=\textwidth]{figures/sel/sspi_TOP_pi_mombr_hatp_difhist_al6_mc.eps}
          \caption{Momentum difference between SFGD and HAT for MC.}
          \label{subfig:sfgp-hatp-dif-mc}
          \end{subfigure}
          \hfill
          \begin{subfigure}[h]{\dbfigwid\textwidth}
          \centering
          \includegraphics[width=\textwidth]{figures/sel/sspi_TOP_pi_mombr_hatp_difhist_al4_CombHAT_data.eps}
          \caption{Momentum difference between SFGD and HAT for data.}
          \label{subfig:sfgp-hatp-dif-data}
          \end{subfigure}
          \caption{Momentum difference for stopping pion control sample.}
          \label{fig:sppi-res}
          \end{figure}

          \begin{table}[htbp]
          \centering
          \begin{tabular}{c|cccc}
                       & MC-$x_0~(\mevc)$ & MC-$\gamma$~($\mevc$) & Data-$x_0~(\mevc)$ & Data-$\gamma$~($\mevc$)\\
          \hline
          FGD & $-25.03 \pm 0.52$ & $85.38 \pm 1.20$ & $-19.43 \pm 1.41$ & $93.57 \pm 4.15$ \\
          SFGD & $-5.29 \pm 0.73$  & $7.49 \pm 0.65$  & $-10.14 \pm 4.55$  & $16.34 \pm 5.21$ \\
          \end{tabular}
          \caption{Fit parameters for the momentum deviation distributions.}
          \label{tab:sppi-res}
          \end{table}

          The systematic error parameters from Table~\ref{tab:sppi-res} are then passed to the HighLAND framework, the selection development and systematics propagation software used at T2K, to propagate the uncertainty through the $\numuccopi$-TL selection.
          The result is shown in Fig.~\ref{fig:tlpi-relerr}.
          \begin{figure}[h]
          \centering
          \begin{subfigure}[h]{\dbfigwid\textwidth}
          \centering
          \includegraphics[width=\textwidth]{figures/sel/relerr-tpcmu.png}
          \caption{Relative error for the TPC-$\mu$ sub-sample.}
          \label{subfig:relerr-tpcmu}
          \end{subfigure}
          \hfill
          \begin{subfigure}[h]{\dbfigwid\textwidth}
          \centering
          \includegraphics[width=\textwidth]{figures/sel/relerr-sfgmu.png}
          \caption{Relative error for the SFGD-$\mu$ sub-sample.}
          \label{subfig:relerr-sfgmu}
          \end{subfigure}
          \caption{Relative error for the $\numuccopi$-TL selection.}
          \label{fig:tlpi-relerr}  
          \end{figure}
          As shown in Fig.~\ref{fig:tlpi-relerr}, due to the limited amount of data, the difference between the data and MC is still relatively large that the magnitude of the average systematic error, about $3\%$ to $5\%$, is slightly larger than that in the FGD analysis, about $2\%$. 
          Due to the incompleteness of global reconstruction and the limited amount of data, this error propagation is performed with only $20$ toys, which can only serve as a proof of the succesful propagation of the systematics.
          Even though no phyics conclusion can be drawn with this limited amount of data, it is promising to observe a considerable decrease in the error for the low momentum pion, comparing to the FGD analysis, showcasing the strength of SFGD and the trackless reconstruction technique.

     \section{Data-MC comparisons}
          Conventionally, kinematic distributions from these selections will be extracted and passed through the unfolding process which maps the reconstructed variables to the truth space. 
          These unfolded distributions can then be used to compare directly with output from MC event generators.
          However, the unfolding process needs to account for all major detector effects, and unfortunately, a full coverage of systematics for the new sub-detectors is not possible within my doctoral study timeline.
          Hence, I have to resort to a reconstruction-level Data-MC comparisons instead.
          Although the comparison result will only be valid for the specific configurations of interaction model used to produce the MC sample, it is the only possible way to utilize the collected data to produce physical results.
     
          With the development of the pion momentum by range reconstruction systematics, it is possible to take a first glimpse of data-MC comparisons for the $\numuccopi$-TL selection. 
          As the global reconstruction is yet to be finalized and only one preliminary systematics is propagated, this data-MC comparison is merely a demonstration of how the data can be used in the future analysis, and no physics conclusion should be drawn.
          The data-MC comparisons are shown in Fig.~\ref{fig:tlpi-datamc}.
          It is reassuring to observe no significant discrepancy between data and MC in the $\numuccopi$-TL selection.
          The data-MC comparison workflow is thus complete.
          Official analysis results can be readily obtained once the various systematics are in place by putting both MC and data through the $\numuccopi$-TL selection.
          \begin{figure}[h]
               \centering
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/datamc-comp-ppi-tpcmu.png}
                    \caption{The TPC-$\mu$ sub-sample: $\ppi$.}
                    \label{subfig:datamc-tpcmu}
               \end{subfigure}
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/datamc-comp-ppi-sfgmu.png}
                    \caption{The SFGD-$\mu$ sub-sample: $\ppi$.}
                    \label{subfig:datamc-sfgmu}
               \end{subfigure}
               \\
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/datamc-comp-tpi-tpcmu.png}
                    \caption{The TPC-$\mu$ sub-sample: $\theta$.}
                    \label{subfig:datamc-theta-tpcmu}
               \end{subfigure}
               \begin{subfigure}{\dbfigwid\textwidth}
                    \includegraphics[width=\textwidth]{figures/sel/datamc-comp-tpi-sfgmu.png}
                    \caption{The SFGD-$\mu$ sub-sample: $\theta$.}
                    \label{subfig:datamc-theta-sfgmu}
               \end{subfigure}
               \caption{Data-MC comparisons for the $\numuccopi$-TL selection.}
               \label{fig:tlpi-datamc}
          \end{figure}

     \section{Discussion}
     \label{sec:technique-disc}
          The two new techniques elaborated in this chapter, the ESC selection and the pion trackless reconstruction, have shown significant improvement in the reconstruction of hadrons in SFGD.
          One leads to a $50\%$ improvement in the momentum resolution of protons, while the other significantly improves the low momentum pion reconstruction efficiency and extends the pion reconstruction threshold to $50~\mevc$, which is impossible for the conventional method.
          Both the $\numuccopi$ and ESC proton selections are finished for primary muons going into the vertical TPC and SFGD. 
          The sub-sample for muons going into HAT is missing as the global reconstruction matching for tracks passing through HAT is still under development.
          However, as the two new techniques in this chapter are developed for hadrons, the performance should not depend on the ending position of the muons.
          Hence, reconstruction improvement showcased in this chapter should be applicable to the muons going into HAT as well.
          With this improvement in the single particle kinematics, it is exciting to see the performance of the reconstruction of the higher level variables, such as the TKI variables, in the next chapter.